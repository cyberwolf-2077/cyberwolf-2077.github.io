<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>RHME-2016 : Fiesta</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-default_background {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: rgba(35, 131, 226, .07); }
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-transparentGray { background-color: rgba(227, 226, 224, 0); }
.select-value-color-translucentGray { background-color: rgba(0, 0, 0, 0.06); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="e42ce76a-5c85-4858-b520-75218b7fded7" class="page sans"><header><img class="page-cover-image" src="https://blog.securitybits.io/img/posts/2019/06/voltage-glitching-on-the-cheap/pexels-photo-132700.jpeg" style="object-position:center 28.04%"/><div class="page-header-icon page-header-icon-with-cover"><img class="icon" src="https://www.notion.so/icons/flash_orange.svg"/></div><h1 class="page-title">RHME-2016 : Fiesta</h1><p class="page-description"></p></header><div class="page-body"><nav id="f95a039c-73c0-4b38-a745-b68f68465620" class="block-color-gray table_of_contents"><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#ef1771e4-58ee-4d21-9fa1-619a04f54c4f">Introduction</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#669f9e3f-278d-4f66-a6f0-0b8db672a068">Components list </a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#3bf60c7c-3dfa-4c22-b305-750ce3ee42f4">Setup</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#52f97845-728d-4efc-887f-9eac446a7607">Loading the program to the chip</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#caea3ef9-e827-47e2-9c9b-fe50b03a8fd3">Setting up the glitch</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2318aca0-4c17-49fd-b1ee-88b8f4c05285">Connecting the glitch source </a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#6d24cbab-abb1-4b16-a997-7b5abb290652">Glitching code </a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#ff6ee794-fbd6-4c98-ba98-4fdf4ca4486a">Time from some trouble shooting </a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#76bc6ea2-4b05-4c84-b2e7-bcb84b647d4b">Idea 1 : power source issue </a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#a123c0db-2da7-4a5d-abbd-d9c4c9d43cfa">Idea 2 : Defective wiring </a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#3774e781-053c-4343-b96e-f796725324af">Idea 3 : Changing the MOSFET</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#64c8dda2-70e0-4093-a19b-4f239d44d1cc">Idea 4 : removing the 680Ω resistor </a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#e1331ded-561b-43c5-8001-e30536249379">Reproduce the glitch under better environment </a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#ba67d5b8-367b-4079-a8d9-6753b09a0942">Lots of fails and lake of understanding</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#ca3a608c-7ef3-4c48-8228-2b2d0e856345">No flag in the output </a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#a88eb113-94f6-41f7-9e18-6062215eaa9b">Flag in the output</a></div></nav><h1 id="ef1771e4-58ee-4d21-9fa1-619a04f54c4f" class="block-color-purple_background">Introduction</h1><p id="bc6f59a3-e40f-466a-8976-3af734b5b037" class="">I just found out that there was a challenge from RHME 2016 about fault injection </p><figure id="eb7b2a67-afc8-4ffa-af6d-294b2ac2cd5f"><a href="https://github.com/Riscure/Rhme-2016/blob/master/challenges/binaries/fiesta/fiesta.hex" class="bookmark source"><div class="bookmark-info"><div class="bookmark-text"><div class="bookmark-title">Rhme-2016/fiesta.hex at master · Riscure/Rhme-2016</div><div class="bookmark-description">Rhme2 challenge (2016). Contribute to Riscure/Rhme-2016 development by creating an account on GitHub.</div></div><div class="bookmark-href"><img src="https://github.com/favicon.ico" class="icon bookmark-icon"/>https://github.com/Riscure/Rhme-2016/blob/master/challenges/binaries/fiesta/fiesta.hex</div></div><img src="https://opengraph.githubassets.com/d741e98db876635d939b2724120be33a0419b4eab68f70d6cb6bf777a807117e/Riscure/Rhme-2016" class="bookmark-image"/></a></figure><p id="d083386e-1656-498b-a4ba-107c9e087144" class="">I decided to follow the tutorial made by Christoffer Claesson with some modifications it </p><figure id="690e4965-ccd9-4c42-90c7-063f33a7f3a9"><a href="https://blog.securitybits.io/2019/06/voltage-glitching-on-the-cheap/" class="bookmark source"><div class="bookmark-info"><div class="bookmark-text"><div class="bookmark-title">Voltage glitching on the cheap</div><div class="bookmark-description">So a couple a weeks ago I decided that I needed more hardware and electronics experience (also writing code and making lights go blink blink is awesome). The foremost purpose of this post is to actually document what I am doing.</div></div><div class="bookmark-href">https://blog.securitybits.io/2019/06/voltage-glitching-on-the-cheap/</div></div><img src="https://blog.securitybits.io/img/posts/2019/06/voltage-glitching-on-the-cheap/pexels-photo-132700.jpeg" class="bookmark-image"/></a></figure><h2 id="669f9e3f-278d-4f66-a6f0-0b8db672a068" class="block-color-pink_background">Components list </h2><div id="8b0ef62f-2c2d-4b34-87b1-d219e06d9c49" class="column-list"><div id="69e8e3f2-e5fb-45ed-ae73-d2e7c9ba827e" style="width:33.333333333333336%" class="column"><ul id="23555d35-6e9c-4358-add8-ad6a2eb42710" class="bulleted-list"><li style="list-style-type:disc">Arduino Uno</li></ul><ul id="49a745be-d80b-4856-8153-ab46f14db345" class="bulleted-list"><li style="list-style-type:disc">Arduino Nano</li></ul></div><div id="7f4fbbeb-7f86-4a7e-a735-51f4b2becb8c" style="width:33.33333333333333%" class="column"><ul id="18023966-5b2c-4b06-9e22-b1cb45a3a033" class="bulleted-list"><li style="list-style-type:disc">100Ω Resistor</li></ul><ul id="0078e96d-c72b-4361-82b2-8857ef93e6d1" class="bulleted-list"><li style="list-style-type:disc">AP3400 MOSFET</li></ul></div><div id="a4ae89cb-ed18-4e43-b657-fe13e42a81ab" style="width:33.333333333333336%" class="column"><ul id="4e951fb3-7f89-4f87-9dff-c1a3852d2e24" class="bulleted-list"><li style="list-style-type:disc">Breadboard</li></ul><ul id="cfa94811-696c-4a58-8681-51e74486d461" class="bulleted-list"><li style="list-style-type:disc">Various Breadboard Lab Cables</li></ul></div></div><h1 id="3bf60c7c-3dfa-4c22-b305-750ce3ee42f4" class="block-color-purple_background">Setup</h1><p id="8f3d5bc8-562d-4398-9e60-db305afc8ca1" class="">My first attempt was with an Arduino uno that had a soldered chip and that wasn’t working at all. so I taught about using my older atmega328P-PU chips.<br/>The first step was to flash them again with the arduino firmware as they where flashed to use their internal 8MHz clocks.<br/>I found a tutorial at the link bellow that worked like a charm <br/></p><figure id="60c0074f-b26b-4a08-a994-b1669e50fafb"><a href="https://www.gotronic.fr/blog/guides/flash-du-bootloader-dune-carte-compatible-arduino/" class="bookmark source"><div class="bookmark-info"><div class="bookmark-text"><div class="bookmark-title">Flash du bootloader d&#x27;une carte compatible Arduino® - Le Blog Gotronic</div></div><div class="bookmark-href"><img src="https://www.gotronic.fr/blog/wp-content/uploads/2017/02/favicon.png" class="icon bookmark-icon"/>https://www.gotronic.fr/blog/guides/flash-du-bootloader-dune-carte-compatible-arduino/</div></div><img src="https://www.gotronic.fr/blog/wp-content/uploads/2020/11/ATmega-1.jpg" class="bookmark-image"/></a></figure><h1 id="52f97845-728d-4efc-887f-9eac446a7607" class="block-color-purple_background">Loading the program to the chip</h1><p id="d83f34c2-c022-4a02-ba8d-aea4f2fb2dd7" class="">After a bit of struggle to get a proper board to run, I followed the instructions of  Christoffer Claesson tutorial to get the vulnerable code running on my arduino uno</p><div id="295bb6be-2b9e-401d-8261-1bc70e5ca77a" class="column-list"><div id="fd98cf80-0664-4b35-8c30-ce0748e83631" style="width:25%" class="column"><figure id="c3a645c4-14f7-4923-b99f-2592e260fc29" class="image"><a href="RHME-2016%20Fiesta%20e42ce76a5c854858b52075218b7fded7/53.png"><img style="width:512px" src="RHME-2016%20Fiesta%20e42ce76a5c854858b52075218b7fded7/53.png"/></a></figure></div><div id="1aa79dee-ffb7-42b5-9422-47c3f35613e2" style="width:75%" class="column"><p id="805d2131-c0a3-4895-a2cf-2f9739f191ca" class="">loading the target source code onto our victim (Uno) using avrdude.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="de5fdeca-0ad9-4bcd-b2ca-78882af3db16" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">wget https://raw.githubusercontent.com/Riscure/Rhme-2016/master/challenges/binaries/fiesta/fiesta.hex
avrdude -c arduino -p atmega328p -p /dev/&lt;UNO Device&gt; -b115200 -u -V -U flash:w:fiesta.hex</code></pre><figure class="block-color-blue_background callout" style="white-space:pre-wrap;display:flex" id="c3f10aea-7ba4-4add-87da-80c3a069f800"><div style="font-size:1.5em"><span class="icon">⚠️</span></div><div style="width:100%">It can also work using the XLoader application</div></figure><p id="4c0bd262-a1cb-4ec1-b689-7ee1d8500361" class="">Once the chip is powered up, we can see the output of the serial communication as follow </p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="abed98b1-980f-45ef-bcf1-e9ef3586b2e3" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">screen /dev/ttyACM1 19200
18:12:58.044 -&gt; RHME2 FI level 1.
18:12:58.044 -&gt;
18:12:58.076 -&gt; Chip status: LockLockLockLockLockLockLockLockLockLockLockLockLockLock[...]</code></pre></div></div><h1 id="caea3ef9-e827-47e2-9c9b-fe50b03a8fd3" class="block-color-purple_background">Setting up the glitch</h1><h2 id="2318aca0-4c17-49fd-b1ee-88b8f4c05285" class="block-color-pink_background">Connecting the glitch source </h2><figure class="block-color-orange_background callout" style="white-space:pre-wrap;display:flex" id="cb1b9c3c-c94b-43fa-9c99-d3ebc6abf8e6"><div style="font-size:1.5em"><span class="icon">⚠️</span></div><div style="width:100%">in order to power glitch the Atmega328p, the micro controller has to be put onto a breadboard, and connect the relevant cables for it to send and receive data. That way it is fairly trivial to control the micro controllers ground, without any interfering capacitors. <br/>This can also be achieved on other hardware (like a Nano which does not have a removable micro controller) by looking up the specification and with a steady hand, desolder the ground pin.<br/></div></figure><p id="9a109da2-d534-4f5b-9da8-d86539d6212f" class="">Here is a simple schematic of how to setup the wiring between the arduino uno and the nano.</p><div id="e2d14557-6ea7-48e1-b3e5-abed41e036ca" class="column-list"><div id="443c4552-954d-4439-9561-a9fdd225c6f5" style="width:75%" class="column"><figure id="7fa64671-16cd-4389-a20a-c6cc041d9dcc" class="image"><a href="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled.png"><img style="width:1146px" src="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled.png"/></a></figure></div><div id="9aa16a7e-b575-4d49-a48e-5c46fd60ada5" style="width:24.999999999999993%" class="column"><figure id="a266f13e-cf03-4618-b695-97473b575285" class="image"><a href="RHME-2016%20Fiesta%20e42ce76a5c854858b52075218b7fded7/93.png"><img style="width:512px" src="RHME-2016%20Fiesta%20e42ce76a5c854858b52075218b7fded7/93.png"/></a></figure></div></div><p id="a5de607b-ae0d-4b57-a320-321ebd9fd622" class="">I used the MOSFET board I previously made for the pink section of the schematic </p><figure id="dee3d18d-3fa6-4e87-aa22-b0a9871084ba"><a href="https://www.notion.so/AP3400-MOSFET-062685488b7e4cb799823908841231f2" class="bookmark source"><div class="bookmark-info"><div class="bookmark-text"><div class="bookmark-title">AP3400 MOSFET</div><div class="bookmark-description">One of the things I want to be able to achieve is fault injection. To do so I need to be able to perform power cuts at precise moments. The best way I found in documentation achieve this goal is by using MOSFETs that are electrical components that act like switches.</div></div><div class="bookmark-href">https://www.notion.so/AP3400-MOSFET-062685488b7e4cb799823908841231f2</div></div><img src="https://www.notion.so/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fc90f18ae-246c-4297-a221-d6861ecbd533%2F13_(2).png?table=block&amp;id=7ef4ca17-61a3-4531-a02c-7be7264b7e5f&amp;width=2000&amp;userId=&amp;cache=v2" class="bookmark-image"/></a></figure><p id="e4aa55fa-3a38-49b2-8939-f46a2268d59b" class="">Now it’s time to connect everything </p><figure id="f1ed2a6c-7434-4595-afbc-79b71a6989b6" class="image"><a href="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%201.png"><img style="width:1299px" src="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%201.png"/></a></figure><h2 id="6d24cbab-abb1-4b16-a997-7b5abb290652" class="">Glitching code </h2><p id="333e08a2-14b2-4cba-bda7-695ac14c7558" class="">This code is copied from Christoffer Claesson tutorial</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3befa2bd-94f3-4665-8486-47e8830ac203" class="code"><code class="language-Arduino" style="white-space:pre-wrap;word-break:break-all">int incomingByte = 0;
char b[5];

int powerPin = 2;
int glitchDelay = 0;

void setup() {
  Serial.begin(19200);
  Serial.println(&quot;Arduino is ready&quot;);

  pinMode(powerPin, OUTPUT);

  digitalWrite(powerPin, HIGH);
  delay(5000);

  Serial.println(&quot;Gliching is ready&quot;);
}

/*
The glitch function have a couple things going on. First of all, it sets the powerPin to LOW, in reference to earlier it simply cuts off the Unos Micro controllers ground. Having the D2 Pin to LOW, enter the for loop. 

Now you might as why a for loop, and not the `delay()`function. Simply because even setting a `delay(1)`for a millisecond, is too slow. Therefor i defined a for loop that will do a simple `waste++;`so that it does a couple instructions each loop. After the for loop setting the D2 pin to HIGH again in order supply the micro controller with power again, completing one `glitch()` function call. Now since this is a loop, the code also increases the `glitchDelay` with 10 each loop, in order to extend the length of the glitch automatically
*/
void glitch(){
  int waste = 0;

  digitalWrite(powerPin, LOW);
  for (int i = 0; i&lt;glitchDelay; i++){ waste++; }                    
  digitalWrite(powerPin, HIGH);

  glitchDelay +=10;
  Serial.println();
  Serial.print(&quot;Glich Delay set to: &quot;);
  Serial.print(glitchDelay);
  Serial.println();
}
/*
The for loop is intended to read 200 bytes on serial Rx, in order to if the glitch is successful, read the flag. then create a delay of 1 second for the power to normalize before calling the function glitch(), this is important as if the target chip is not in a normal state the glitch can have some interesting (read corrupting) results.
*/
void loop() {

  for (int i = 0; i&lt;200;i++){
      if (Serial.available() &gt; 0) {
        // read the incoming byte:
        incomingByte = Serial.read();
        Serial.print(char(incomingByte));
      }
    }

    delay(1000);
    glitch();
}</code></pre><p id="3ee86b9b-5661-4814-be05-c87859a2125e" class="">This code is pushed on the Arduino nano board and now we hope for the best </p><div id="45595398-3f24-43f1-9e81-01affe7b45b3" class="column-list"><div id="a212103f-3a55-4fba-afe3-87f054c1184e" style="width:50%" class="column"><figure id="0cf46549-9041-4932-b47b-5037593ee08f" class="image"><a href="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%202.png"><img style="width:490px" src="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%202.png"/></a></figure></div><div id="e604046b-a4df-4996-b2a4-2fa60038ba82" style="width:50%" class="column"><figure id="98b56619-99ee-4ff6-8603-59ba81ed9005" class="image"><a href="RHME-2016%20Fiesta%20e42ce76a5c854858b52075218b7fded7/102.png"><img style="width:512px" src="RHME-2016%20Fiesta%20e42ce76a5c854858b52075218b7fded7/102.png"/></a></figure><p id="300a8d2f-1ff5-476e-9867-9605707c97f9" class="">sadly, it looks like the glitch didn’t worked as expected … On Christoffer Claesson tutorial the glitch occurs when the delay reach 70 but nothing happened here ..</p><p id="e3a0d9e7-4468-429d-85e5-e117c2e00020" class="">I tried several times to restart the boards and try again but nothing seems to be working this way.</p><p id="4fa9a2d7-6e0b-4f95-900c-5631198751a4" class="">
</p></div></div><h1 id="ff6ee794-fbd6-4c98-ba98-4fdf4ca4486a" class="block-color-purple_background">Time from some trouble shooting </h1><h2 id="76bc6ea2-4b05-4c84-b2e7-bcb84b647d4b" class="block-color-pink_background">Idea 1 : power source issue </h2><div id="26ef57ad-4b24-46ea-8a75-939da05029a0" class="column-list"><div id="75d8a961-c4ff-4a33-9a9a-95ecf254417f" style="width:25%" class="column"><figure id="214531f8-d3ac-435a-ab49-3d37dcf2c13c" class="image"><a href="RHME-2016%20Fiesta%20e42ce76a5c854858b52075218b7fded7/117.png"><img style="width:512px" src="RHME-2016%20Fiesta%20e42ce76a5c854858b52075218b7fded7/117.png"/></a></figure></div><div id="d72ea451-d66f-43f0-93f0-c2e0b4ba8605" style="width:75%" class="column"><p id="45304279-4f6d-48bc-aac8-3319eb3f2793" class="">One of the idea I came with was to try to power up the arduino uno by pluging it’s Vin pin to the Vcc of the arduino nano</p><p id="cc093ce0-5165-45ec-9463-f9397911f2d7" class="">but the problem seems to be the same as the board reboot at every glitch </p><figure id="3d5f2c66-f148-4b8e-aac3-4be5b00fa02b" class="image"><a href="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%203.png"><img style="width:496px" src="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%203.png"/></a></figure></div></div><h2 id="a123c0db-2da7-4a5d-abbd-d9c4c9d43cfa" class="block-color-pink_background">Idea 2 : Defective wiring </h2><p id="0081e96b-8da7-45a9-a9a5-d794a5c967b8" class="">When looking a bit closer at the photo of the cabling in Christoffer Claesson tutorial, I was bothered by the MOSFET they use and decided to make sure my connexion would make sense and would be the equivalent with the one I am using </p><div id="d036bbe0-a7ac-4847-ad9e-10e47dec82ba" class="column-list"><div id="dcb6cee8-81e6-4e5d-9fa1-6c95930ed808" style="width:29.166666666666664%" class="column"><figure id="d126ef3c-c88f-4e33-b675-d8cf32e253ad" class="image"><a href="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%204.png"><img style="width:360px" src="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%204.png"/></a><figcaption>Pin layout of my AP3400 MOSFET </figcaption></figure></div><div id="d369a3a6-ee89-4314-8410-acd187df41e1" style="width:29.166666666666664%" class="column"><figure id="740b2147-43f2-4c54-a42d-1097de65b6bc" class="image"><a href="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%205.png"><img style="width:746px" src="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%205.png"/></a><figcaption>2N7000 Pin layout</figcaption></figure></div><div id="cf9b1358-104b-44cf-8060-abcf319da0b4" style="width:41.66666666666667%" class="column"><figure id="469c087b-7658-4c37-a2be-4cf91309d57a" class="image"><a href="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%206.png"><img style="width:1459px" src="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%206.png"/></a></figure></div></div><div id="765d69e7-71ab-484d-b6d9-a07a8ee9ce65" class="column-list"><div id="512ef941-b5f6-49a6-b931-732e7e4cc166" style="width:50%" class="column"><p id="8a1e61ae-441c-4ec2-a594-854c87c423e6" class="">On my setup here is how it was cabled  :</p><p id="f57ed2ab-e961-4e8c-bdd0-3843d3ce8770" class="block-color-teal_background">PIN1 (S) &gt; Linked to Arduino nano GND</p><p id="09818075-425f-496c-8bd5-e4d089351b1c" class="block-color-orange_background">Pin2 (G) &gt; over 680Ω resistor to D2 on Arduino nano</p><p id="3b3bf421-06cb-46e1-93be-d160b9bc3e81" class="block-color-blue_background">Pin3 (D) &gt; Linked to Arduino uno ATMEGA328P-PU GND (pin8)</p></div><div id="d79e91c3-944c-43c1-a171-3afcfc582e9f" style="width:50%" class="column"><p id="45e9a856-7bce-43b3-8b3f-b4b175dadf5e" class="">On Christoffer Claesson setup :</p><p id="3e3b6481-3445-4827-bfe4-8c3197041a40" class="block-color-blue_background">Pin1 (S) &gt; Linked to Arduino uno ATMEGA328P-PU GND (pin8)</p><p id="b0f519fa-4f09-4937-aa0d-4764e30730d7" class="block-color-orange_background">Pin2 (G) &gt; over 680Ω resistor to D2 on Arduino nano</p><p id="719747c1-9060-43bd-8af4-45ff36ef7bbc" class="block-color-teal_background">Pin3 (D) &gt; Linked to Arduino nano GND</p></div></div><p id="88a1f0c8-e6d5-4ef9-8f8a-9bcdcca9d86c" class="">It looks like the layout I made was improper compared to the one from the tutorial I was following. So I decided to rewire my MOSFET accordingly </p><div id="0c2e20a2-099f-4de5-8f32-7d634c513ba6" class="column-list"><div id="269907ce-d3fe-4011-9afd-9b439dff22a8" style="width:37.5%" class="column"><figure id="7273d206-af64-448c-9692-f78018f3fb6f" class="image"><a href="RHME-2016%20Fiesta%20e42ce76a5c854858b52075218b7fded7/67.png"><img style="width:432px" src="RHME-2016%20Fiesta%20e42ce76a5c854858b52075218b7fded7/67.png"/></a></figure></div><div id="14c4c56b-df07-44f4-b8e4-7fcb568d93a6" style="width:62.5%" class="column"><figure id="cb8cca8e-a742-44e6-b1b7-5c131c956f6f" class="image"><a href="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%207.png"><img style="width:720px" src="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%207.png"/></a></figure><p id="c58c7813-220f-4842-a626-70c07273e113" class="">No more board reset, but still no signs of a working glitch …</p></div></div><h2 id="3774e781-053c-4343-b96e-f796725324af" class="block-color-pink_background">Idea 3 : Changing the MOSFET</h2><p id="3b0eb0b7-6a09-4834-b7b4-c6e286206ab1" class="">The other idea I got was to swap my AP3400 MOSFET with a 2N2222 as I don’t have any 2n7000 in stock but to try to replicate the tutoral board as close as possible </p><figure class="block-color-blue_background callout" style="white-space:pre-wrap;display:flex" id="94c5aa02-4603-47be-a10f-90ee821f4789"><div style="font-size:1.5em"><span class="icon">⚠️</span></div><div style="width:100%">I afterward noticed there where a difference between 2N2222 and 2N7000</div></figure><div id="f6d1583b-0122-4512-aa57-f7aceb839303" class="column-list"><div id="8765a765-8c72-43ed-8199-fbf7999b5b2d" style="width:50%" class="column"><figure id="3dde7f09-8e82-4c07-9c98-a15e4dac3d79" class="image"><a href="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%208.png"><img style="width:668px" src="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%208.png"/></a></figure></div><div id="14e0260e-67ee-4c60-aade-f7288e172f25" style="width:50%" class="column"><p id="b499cf19-c5cf-4f0d-9d27-5e16d955a94a" class="">With this setup, we are facing once again the reboot of the board each times we try to glitch it  and this issue is the same whether I use the pin layout I had or the one from Christoffer Claesson tutorial</p><figure id="aff01cc4-2d00-4e19-a5d3-147bed7a280a" class="image"><a href="RHME-2016%20Fiesta%20e42ce76a5c854858b52075218b7fded7/78.png"><img style="width:240px" src="RHME-2016%20Fiesta%20e42ce76a5c854858b52075218b7fded7/78.png"/></a></figure></div></div><h2 id="64c8dda2-70e0-4093-a19b-4f239d44d1cc" class="block-color-pink_background">Idea 4 : removing the 680Ω resistor </h2><p id="e7620036-2879-4e0c-b190-b307240aa48c" class="">While I am at trying stupid things, I decided to test the same setup as above but without the 680Ω resistor</p><div id="e34f1da1-1f62-42f1-8c2c-842791af63a9" class="column-list"><div id="56e4dbf8-9fe4-4dff-835e-822dd8f47c10" style="width:25%" class="column"><figure id="9fbc0976-1adf-4e50-8635-476d35f99a38" class="image"><a href="RHME-2016%20Fiesta%20e42ce76a5c854858b52075218b7fded7/50.png"><img style="width:288px" src="RHME-2016%20Fiesta%20e42ce76a5c854858b52075218b7fded7/50.png"/></a></figure></div><div id="ab802cc9-30bc-4e6c-950a-b2d6777564b1" style="width:75%" class="column"><figure id="fdf6e8f7-54a4-4862-9d3e-611870b753fb" class="image"><a href="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%209.png"><img style="width:643px" src="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%209.png"/></a><figcaption>No luck with the 2N2222 setup</figcaption></figure></div></div><div id="15b6af64-24c0-49dd-a269-3b0e3a659ffa" class="column-list"><div id="991ccd82-46a8-4bac-969c-49129381cd84" style="width:62.5%" class="column"><figure id="8edc7ecd-d02c-414a-9a05-373bafabb1dd" class="image"><a href="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2010.png"><img style="width:772px" src="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2010.png"/></a></figure></div><div id="9515081e-4d57-47b3-9c5f-a8cad9e07b18" style="width:37.5%" class="column"><figure id="215cf4fb-d970-4e3d-8377-306b40e94042" class="image"><a href="RHME-2016%20Fiesta%20e42ce76a5c854858b52075218b7fded7/108.png"><img style="width:336px" src="RHME-2016%20Fiesta%20e42ce76a5c854858b52075218b7fded7/108.png"/></a></figure></div></div><h1 id="e1331ded-561b-43c5-8001-e30536249379" class="block-color-purple_background">Reproduce the glitch under better environment </h1><p id="586da6c2-8a06-4dda-af50-679bd6be8365" class="">It finally worked … I must admit I don’t really understand why … <br/>I got quite annoyed by the  char in the first glitch so I tried to glitch it several times but ran in the same problem multiple times<br/></p><figure id="2a0619d6-4c97-4ac1-89d3-84c2ba5ef9ad" class="image" style="text-align:left"><a href="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2011.png"><img style="width:1008px" src="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2011.png"/></a></figure><p id="f63b50c2-77a1-442e-8bb4-b992e272fe48" class="">I noticed there are multiple delays that could make the loop to break as shown in the following screenshot where a delay of 130 is making the loop to break </p><figure id="8dd93359-a1d9-416e-8820-34bc5b313854" class="image"><a href="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2012.png"><img style="width:550px" src="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2012.png"/></a></figure><p id="aeda8616-bbd7-49e2-9bea-e793ec170f82" class="">I also faced some weird behaviour where nothing was working anymore … that’s for the next part </p><p id="e3a2b14b-e692-468d-a470-672213cbb2dc" class="">Ok now we know that we can produce the glitch which is super cool. but it also quickly showed some signs of default somewhere.<br/>Knowing that I can make the fault injection with my equipment, I’ll now redo the setup and try again in a cleaner way<br/></p><p id="40744cca-ba17-4ba0-8590-5d113ddb1941" class="">After a bit of testing, it appear that I can get this result every time if I put a resistor on the Gate of the MOSFET (680Ω or 330Ω) so a resistor in necessary to get the results readable.</p><div id="2c4071ae-6d7d-40fa-9466-0a097d30c9b5" class="column-list"><div id="feb16a50-9105-49ed-bd29-ffd5f6225893" style="width:50%" class="column"><figure id="66796bdb-808b-485f-8488-878c44da8f1c" class="image"><a href="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2013.png"><img style="width:734px" src="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2013.png"/></a></figure><p id="4af084b8-de34-456f-bc75-4a8924caa541" class="">However, using 680Ω or 330Ω resistors on the gate of the MOSFET makes it unable to injection into the ATMEGA328P-PU chip</p><p id="6f1cd9a3-779c-4ad8-8faf-f2176e13de13" class="">I have decided to go through lower value resistor to see if it could help with the injection and keeping the Arduino uno output proper and try to get the flag<br/>After several unsuccessful attempts, I got a proper result using 100Ω resistors <br/></p></div><div id="2064e1f0-1a7b-4286-bd4b-cfaba5522f2c" style="width:50%" class="column"><figure id="07848793-a131-440c-b0be-b3a2fe26c7d1" class="image"><a href="RHME-2016%20Fiesta%20e42ce76a5c854858b52075218b7fded7/105.png"><img style="width:336px" src="RHME-2016%20Fiesta%20e42ce76a5c854858b52075218b7fded7/105.png"/></a></figure></div></div><div id="4eba967a-065d-4372-9484-6588a52b2c04" class="column-list"><div id="7ec7ecbd-933b-477a-8da4-32d21692327e" style="width:25%" class="column"><figure id="22bc5376-2101-4eb3-9e97-831dd2bcfbfe" class="image"><a href="RHME-2016%20Fiesta%20e42ce76a5c854858b52075218b7fded7/53%201.png"><img style="width:512px" src="RHME-2016%20Fiesta%20e42ce76a5c854858b52075218b7fded7/53%201.png"/></a></figure></div><div id="4243926e-c39a-4cef-838c-7b18403053fa" style="width:75%" class="column"><figure id="425adef5-aa43-4e2c-a2e2-1001e8724c97" class="image"><a href="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2014.png"><img style="width:868px" src="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2014.png"/></a></figure></div></div><p id="621243a4-1441-41f1-ae5f-ee16bacd9000" class="">I decided to try again a second time and ran into a chip fail and restart but it seems like the Fault injection worked later on</p><div id="3d76e185-e1e1-4b12-80df-4c585bff76b2" class="column-list"><div id="51a1e6e9-0e57-437c-8070-a268a2f826c1" style="width:50%" class="column"><figure id="234bb38d-1acf-4430-ac21-222009a9cf8a" class="image"><a href="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2015.png"><img style="width:688px" src="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2015.png"/></a></figure></div><div id="a3f23109-505f-4865-b5aa-148e2884547f" style="width:50%" class="column"><figure id="941f64ed-230c-438c-8b19-2b014fe3a5c5" class="image"><a href="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2016.png"><img style="width:671px" src="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2016.png"/></a></figure></div></div><p id="a914681b-b3b6-45ed-b1a7-2694f172354a" class="">I decided to ran it again several times to get a proper idea of the capability to replay the attack every times </p><div id="f5d0f40e-2d3a-4c24-b8e7-a5dec8f3a6d3" class="column-list"><div id="9300525f-3acb-40ee-abc2-4822c3cad75a" style="width:43.75%" class="column"><figure id="fa2647cc-4535-4fb2-af02-3b2192acf805" class="image"><a href="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2017.png"><img style="width:602px" src="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2017.png"/></a></figure><figure id="68b574b5-5b74-40f2-b5b6-c26dcdd982fe" class="image"><a href="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2018.png"><img style="width:590px" src="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2018.png"/></a></figure><figure id="16a248f0-e4d7-4920-bf22-1c8f94cc34ec" class="image"><a href="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2019.png"><img style="width:591px" src="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2019.png"/></a></figure><figure id="efe5b055-6a5a-4c08-9b3c-d6f7d87c1f3e" class="image"><a href="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2020.png"><img style="width:579px" src="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2020.png"/></a></figure></div><div id="c9c1b4b4-45d4-4081-9ef1-918ed3a79883" style="width:56.25%" class="column"><figure id="985ed44c-16e5-4daf-8a1a-6816709e8636" class="image"><a href="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2021.png"><img style="width:614px" src="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2021.png"/></a></figure><figure id="2afe704c-fdad-434b-9d77-3d11035ecd55" class="image"><a href="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2022.png"><img style="width:603px" src="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2022.png"/></a></figure><figure id="7a6ed8e7-b73a-4c2d-bc3d-947358eb7829" class="image"><a href="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2023.png"><img style="width:624px" src="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2023.png"/></a></figure></div></div><p id="5bca1e18-fec8-4868-bf7f-d99eb7b04b3f" class="">After a dozen of successful run in a raw I think that the attack is working properly under these parameters </p><p id="1d45d5b2-ceda-48cb-b1ac-da5d713a32e0" class="">Here is the final layout I used </p><div id="8a678445-eea1-40b3-96a7-84aa46d5287d" class="column-list"><div id="1a0e92ee-7862-4d2e-9384-57c51309a74d" style="width:68.75%" class="column"><figure id="8db59837-f253-43b7-9fa4-e374e9ec3c16" class="image"><a href="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2024.png"><img style="width:1103px" src="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2024.png"/></a></figure></div><div id="f6423112-4ccb-4f40-b2d9-a183834c0985" style="width:31.250000000000007%" class="column"><figure id="d2ad7ae7-e15d-479a-953d-02ed64b61bac" class="image"><a href="RHME-2016%20Fiesta%20e42ce76a5c854858b52075218b7fded7/107_2_(2).png"><img style="width:432px" src="RHME-2016%20Fiesta%20e42ce76a5c854858b52075218b7fded7/107_2_(2).png"/></a></figure></div></div><h1 id="ba67d5b8-367b-4079-a8d9-6753b09a0942" class="block-color-purple_background">Lots of fails and lake of understanding</h1><p id="4454d366-5272-4732-9af1-c3a68284244d" class="">Here is a selection of outputs that have failed, or showed the flag but with missing elements afterward </p><h2 id="ca3a608c-7ef3-4c48-8228-2b2d0e856345" class="block-color-pink_background">No flag in the output </h2><div id="aa51bd03-252b-4a12-b7ca-4db61bb18259" class="column-list"><div id="5f810d1b-9f67-4670-a05e-7f993da70709" style="width:50%" class="column"><figure id="4761f63b-116a-4793-a216-2c38b48e46f1" class="image"><a href="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2025.png"><img style="width:660px" src="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2025.png"/></a></figure><figure id="c90519cd-6573-4610-ac75-345f6f9b7124" class="image"><a href="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2026.png"><img style="width:730px" src="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2026.png"/></a></figure></div><div id="d5f73a34-11aa-40e8-a51d-75f5d2e4307b" style="width:50%" class="column"><figure id="d8e7e03d-95a2-4650-9613-222b8e61b646" class="image"><a href="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2027.png"><img style="width:668px" src="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2027.png"/></a></figure><figure id="58e3e46d-81c8-4946-9b28-4f0c46d4371e" class="image"><a href="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2028.png"><img style="width:389px" src="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2028.png"/></a></figure><p id="03a7a522-a3a8-47c8-b52f-b418651f8d6b" class="">
</p></div></div><h2 id="a88eb113-94f6-41f7-9e18-6062215eaa9b" class="block-color-pink_background">Flag in the output</h2><figure id="ce8b4cbf-2ad6-4fad-9444-9b6215290a89" class="image"><a href="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2011.png"><img style="width:843px" src="../RHME-2016%20Fiesta%20or%20the%205$%20Fault%20Injection%20d0d233edf36b4d0f991eb44d658806ed/Untitled%2011.png"/></a></figure><p id="c6ab9f05-75a9-4d52-ab23-cd5aa3804446" class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>